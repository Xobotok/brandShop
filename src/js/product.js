"use strict";var _createClass=function(){function a(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sortingItems(e,t){switch(e){case"Name":var i=t.length;do{for(var a=!1,s=1;s<i;s++)if(t[s-1].title.toUpperCase()>t[s].title.toUpperCase()){var r=t[s-1];t[s-1]=t[s],t[s]=r,a=!0}}while(a);break;case"Price":var n=t.length;do{a=!1;for(var o=1;o<n;o++)if(t[o-1].price>t[o].price){var c=t[o-1];t[o-1]=t[o],t[o]=c,a=!0}}while(a);break;case"Rating":var l=t.length;do{a=!1;for(var p=1;p<l;p++)if(t[p-1].rating>t[p].rating){var d=t[p-1];t[p-1]=t[p],t[p]=d,a=!0}}while(a)}return t}var ProductItems=function(){function a(e,t,i){_classCallCheck(this,a),this.basket=e,this.row=t,this.column=i,this.items=[],this.pages=[],this.activePage=1,this.sorting="",this.jsonRequest("./js/JSON/items.json")}return _createClass(a,[{key:"run",value:function(){$("#featured").empty(),sortingItems(this.sorting,this.items),this.pages=this.makePages(this.items,this.row*this.column),this.renderPage(this.pages,this.activePage,this.row,this.column),this.renderPageCount()}},{key:"showItemsOnPage",value:function(e){this.row=e/this.column,this.run()}},{key:"renderPage",value:function(l,p,d,u){var h=this;0===p&&(p=1),0<this.items.length?function(){var a=h,s=0;l.length<p?(s=l[l.length-1].pageItems,h.activePage=l.length):s=l[p-1].pageItems,$("div.featured__itemblock").remove();for(var e=0;e<d;e++)for(var r=$("<div />",{class:"featured__itemblock"}).appendTo("#featured"),t=function(e){var t=$('<div class = "featured__item"></div>').appendTo(r);t.attr("id",s[e].id),$(t).draggable({revert:!0,revertDuration:400,scrol:!0,zIndex:99}),$("#basket__drop").droppable({drop:function(){$(".ui-droppable-active").addClass("visible");for(var e=0;e<s.length;e++)if($(".ui-draggable-dragging").attr("id")===s[e].id){a.basket.addItem(s[e]);break}var t=$('<h4 class = item__added><i class="fa fa-check-circle-o" aria-hidden="true"></i></h4>');t.dialog({modal:!0,show:"fade",hide:"fade"}),t.dialog("close")}});var i=$("<div />",{class:"substrate"}).appendTo(t);$("<img />",{class:"featured__item_img",src:s[e].img}).appendTo(i),$("<a />",{class:"featured__item_title",text:s[e].title,href:s[e].link}).appendTo(t),$("<h4 />",{class:"featured__item_price",text:"$"+s[e].price.toFixed(2)}).appendTo(t);$('<button class = "featured__item_add"><i class = "fa fa-cart-plus"></i>Add to Cart</button>',{}).appendTo(t).on("click",function(){console.log(s[e]),a.basket.addItem(s[e])})},i=u*e;i<u*(e+1)&&i<s.length;i++)t(i);for(var n=0;n<$(".sorting__by_count").length;n++)$(".sorting__by_count")[n].onclick=function(){a.sorting=this.textContent,a.run()};for(var o=function(e){$(".sorting__container_count")[e].onclick=function(){a.showItemsOnPage(parseInt($(".sorting__container_count")[e].textContent))}},c=0;c<$(".sorting__container_count").length;c++)o(c)}():this.noItemsForRender()}},{key:"makePages",value:function(e,t){for(var i=[],a=0;a<e.length/t;a++){for(var s={id:a,pageItems:[]},r=t*a;r<e.length&&r<t*(a+1);r++)s.pageItems.push(e[r]);i.push(s)}return i}},{key:"renderPageCount",value:function(){var i=this,a=$("<div/>",{class:"pagecontainer",id:"pagecontainer"});a.appendTo("#featured");var e=$('<p class = page><i class="fa fa-chevron-left" aria-hidden="true"></i></p>');e.appendTo($(a)),e.on("click",function(){1<i.activePage&&(i.activePage--,i.renderPage(i.pages,i.activePage,i.row,i.column),$(".page").removeClass("page__active"),$("#page"+(i.activePage-1)).addClass("page__active"))});for(var t=function(e){var t=$("<p />",{class:"page",text:e+1,id:"page"+e});t.appendTo(a),t.on("click",function(){i.activePage=e+1,i.renderPage(i.pages,i.activePage,i.row,i.column),$(".page").removeClass("page__active"),$("#page"+(i.activePage-1)).addClass("page__active")})},s=0;s<this.pages.length;s++)t(s);var r=$('<p class = page><i class="fa fa-chevron-right" aria-hidden="true"></i></p>');r.appendTo($(a)),r.on("click",function(){i.activePage<i.pages.length&&(i.activePage++,i.renderPage(i.pages,i.activePage,i.row,i.column),$(".page").removeClass("page__active"),$("#page"+(i.activePage-1)).addClass("page__active"))}),$("#page"+(this.activePage-1)).addClass("page__active");var n=$("<button />",{class:"featured__viewall",text:"View All"});n.appendTo($("#featured")),n.on("click",function(){location.reload()})}},{key:"jsonRequest",value:function(e){$.get({url:e,dataType:"json",context:this,success:function(e){this.items=[];for(var t=0;t<e.items.length;t++)this.items.push(new Item(e.items[t].id,e.items[t].title,e.items[t].description,e.items[t].img,e.items[t].link,e.items[t].price,e.items[t].rating,e.items[t].designer,e.items[t].material,e.items[t].brand,e.items[t].category,e.items[t].color,e.items[t].size));this.run()}})}},{key:"noItemsForRender",value:function(){$("#featured").empty(),this.items=[];var e=$("<div />",{class:"featured__noitems"});e.appendTo($("#featured")),$("<h3 />",{class:"featured__noitems_text",text:"There are no products matching your search."}).appendTo(e);var t=$("<button />",{class:"featured__viewall",text:"View All"});t.appendTo($("#featured")),t.on("click",function(){location.reload()})}}]),a}();function removeDuplicates(e){for(var t=e,i=0;i<t.length;i++)for(var a=i;a<e.length;a++)t[i]===t[a+1]&&(t.splice(a+1,1),a--);return t}function removeDuplicatesDoubleArray(e){for(var t=e,i=[],a=0;a<t.length;a++)for(var s=0;s<t[a].length;s++)i.push(t[a][s]);return t=removeDuplicates(i)}var FilterList=function(){function i(e,t){_classCallCheck(this,i),$("#dropfilter").empty(),$("input:checked").prop("checked",!1),this.items=[],this.activeFilter="",this.activeFilterType="",this.productItems=t,this.filterList=[],this.prices=[],this.takeItemsFrom(e)}return _createClass(i,[{key:"takeItemsFrom",value:function(e){$.get({url:e,dataType:"json",context:this,success:function(e){this.items=[];for(var t=0;t<e.items.length;t++)this.items.push(new Item(e.items[t].id,e.items[t].title,e.items[t].description,e.items[t].img,e.items[t].link,e.items[t].price,e.items[t].rating,e.items[t].designer,e.items[t].material,e.items[t].brand,e.items[t].category,e.items[t].color,e.items[t].size));this.run()}})}},{key:"run",value:function(){sortingItems(this.productItems.sorting,this.items),this.makeFilters(this.items),this.spoilerRender(this.filterList[4],this.filterList[3],this.filterList[1],this),this.priceSlider(this)}},{key:"makeFilters",value:function(e){for(var t=e,i=[[],[],[],[],[],[],[]],a=0;a<e.length;a++){i[0].push(t[a].price),i[1].push(t[a].designer),i[2].push(t[a].material),i[3].push(t[a].brand),i[4].push(t[a].category);for(var s=0;s<e[a].size.length;s++)i[5].push(t[a].size[s]);for(var r=0;r<e[a].color.length;r++)i[6].push(t[a].color[r])}for(var n=0;n<i.length;n++)i[n]=removeDuplicates(i[n]);this.filterList=i}},{key:"spoilerRender",value:function(s,r,n,o){var e=$('<button class = products__button id = category__button>category<i class="fa fa-chevron-down" aria-hidden="true"></i></button>'),t=$('<button class = products__button id = brand__button>brand<i class="fa fa-chevron-down" aria-hidden="true"></i></button>'),i=$('<button class = products__button id = designer__button>designer<i class="fa fa-chevron-down" aria-hidden="true"></i></button>');e.appendTo($("#dropfilter"));var c=$("<ul />",{class:"products__filter"});c.appendTo($("#dropfilter")),t.appendTo($("#dropfilter"));var l=$("<ul />",{class:"products__filter"});l.appendTo($("#dropfilter")),i.appendTo($("#dropfilter"));var p=$("<ul />",{class:"products__filter"});p.appendTo($("#dropfilter"));for(var a=function(a){var e=$("<li />",{class:"products__filter_category",text:s[a],id:"category"+a});e.on("click",function(){o.appendFilter("category",s[a]);for(var e=0;e<s.length;e++)$("#category"+e).removeClass("active");for(var t=0;t<r.length;t++)$("#brand"+t).removeClass("active");for(var i=0;i<s.length;i++)$("#designer"+i).removeClass("active");$("#category"+a).addClass("active")}),e.appendTo(c)},d=0;d<s.length;d++)a(d);var u=function(a){var e=$("<li />",{class:"products__filter_category",id:"brand"+a,text:r[a]});e.appendTo(l),e.on("click",function(){o.appendFilter("brand",r[a]);for(var e=0;e<s.length;e++)$("#category"+e).removeClass("active");for(var t=0;t<r.length;t++)$("#brand"+t).removeClass("active");for(var i=0;i<s.length;i++)$("#designer"+i).removeClass("active");$("#brand"+a).addClass("active")})};for(d=0;d<r.length;d++)u(d);var h=function(a){var e=$("<li />",{class:"products__filter_category",text:n[a],id:"designer"+a});e.on("click",function(){o.appendFilter("designer",n[a]);for(var e=0;e<s.length;e++)$("#category"+e).removeClass("active");for(var t=0;t<r.length;t++)$("#brand"+t).removeClass("active");for(var i=0;i<s.length;i++)$("#designer"+i).removeClass("active");$("#designer"+a).addClass("active")}),e.appendTo(p)};for(d=0;d<n.length;d++)h(d);e.on("click",function(){c.is(":visible")?e.removeClass("opened"):e.addClass("opened"),c.toggle(500)}),t.on("click",function(){l.is(":visible")?t.removeClass("opened"):t.addClass("opened"),l.toggle(500)}),$("#filter__size_xxs").change(function(){o.appendFilter("size",$("#filter__size_xxs").name)}),$("#filter__size_xs").change(function(){o.appendFilter("size",$("#filter__size_xs").name)}),$("#filter__size_s").change(function(){o.appendFilter("size",$("#filter__size_s").name)}),$("#filter__size_m").change(function(){o.appendFilter("size",$("#filter__size_m").name)}),$("#filter__size_l").change(function(){o.appendFilter("size",$("#filter__size_l").name)}),$("#filter__size_xl").change(function(){o.appendFilter("size",$("#filter__size_xl").name)}),$("#filter__size_xxl").change(function(){o.appendFilter("size",$("#filter__size_xxl").name)}),i.on("click",function(){p.is(":visible")?i.removeClass("opened"):i.addClass("opened"),p.toggle(500)})}},{key:"priceSlider",value:function(i){for(var e=[],t=0,a=this.items[0].price,s=0;s<this.items.length;s++)this.items[s].price<a&&(a=Math.ceil(this.items[s].price)),this.items[s].price>t&&(t=Math.ceil(this.items[s].price));e[0]=a,e[1]=t;var r=$("<div />",{class:"price__value_current",id:"price__value_current"});r.appendTo($("#price__slider")),$("<p />",{class:"price__value_min",id:"current__price_min",text:"$"+a+"-"}).appendTo(r),$("<p />",{class:"price__value_max",id:"current__price_max",text:"$"+t}).appendTo(r);var n=$("#price__slider").slider({values:e,range:!0,min:e[0],max:e[1],change:function(e,t){i.appendFilter("price",t.values),$("#current__price_min").text("$"+t.values[0]+"-"),$("#current__price_max").text("$"+t.values[1])}});$("#filter__price_min").append("$"+n.slider("values")[0]),$("#filter__price_max").append("$"+n.slider("values")[1])}},{key:"appendFilter",value:function(i,a){$.get({url:"./js/JSON/items.json",dataType:"json",context:this,success:function(e){this.items=[];for(var t=0;t<e.items.length;t++)this.items.push(new Item(e.items[t].id,e.items[t].title,e.items[t].description,e.items[t].img,e.items[t].link,e.items[t].price,e.items[t].rating,e.items[t].designer,e.items[t].material,e.items[t].brand,e.items[t].category,e.items[t].color,e.items[t].size));sortingItems(this.items,this.productItems.sorting),this.runFilter(this.items,i,a)}})}},{key:"runFilter",value:function(e,t,i){var a=[];switch("price"===t&&(this.prices=i),t){case"category":this.activeFilterType="category",this.activeFilter=i;break;case"brand":this.activeFilterType="brand",this.activeFilter=i;break;case"designer":this.activeFilterType="designer",this.activeFilter=i}switch(this.activeFilterType){case"category":for(var s=0;s<e.length;s++)e[s].category===this.activeFilter&&a.push(e[s]);break;case"brand":for(var r=0;r<e.length;r++)e[r].brand===this.activeFilter&&a.push(e[r]);break;case"designer":for(var n=0;n<e.length;n++)e[n].designer===this.activeFilter&&a.push(e[n])}a.length<1&&(a=e),a.length<1&&(a=this.items);var o=$("input:checkbox:checked"),c=[];if(0<o.length){for(var l=0;l<o.length;l++)c.push(o[l].name);for(var p=0;p<a.length;p++){for(var d=!1,u=0;u<a[p].size.length;u++)for(var h=0;h<c.length;h++)c[h]===a[p].size[u]&&(d=!0);!1===d&&(a.splice(p,1),p--)}}for(var g=0;g<a.length;g++)(a[g].price<this.prices[0]||a[g].price>this.prices[1])&&(a.splice(g,1),g--);0<a.length?(this.productItems.activePage>this.productItems.pages.length&&(this.productItems.activePage=this.productItems.pages.length),sortingItems(this.productItems.sorting,a),this.productItems.items=a,this.productItems.run()):this.productItems.noItemsForRender()}}]),i}();